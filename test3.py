# -*- coding: utf-8 -*-
# @Author  : Peidong
# @Site    : 
# @File    : recommendsystem.py
# @Software: PyCharm
# 使用MovieLens数据集，它是在实现和测试推荐引擎时所使用的最常见的数据集之一。它包含来自于943个用户
# 以及精选的1682部电影的100K个电影打分。
import numpy as np
import math
import pandas as pd

def aa(row1, row2):
    avg1 = np.mean(row1)
    avg2 = np.mean(row2)
    a = 0
    b = 0
    c = 0
    for i in range(len(row1)):
        a += (row1[i] - avg1)*(row2[i] - avg2)
        b += pow(row1[i] - avg1, 2)
        c += pow(row2[i] - avg2, 2)
    return a / (math.sqrt(b)*math.sqrt(c))

 index: 0, ClusterItem: [91, 101, 233, 283, 288, 307, 322, 372, 446, 447, 451, 503, 567, 586, 597]
index: 1, ClusterItem: [1, 4, 10, 20, 27, 36, 43, 46, 53, 54, 56, 67, 74, 75, 80, 88, 103, 105, 125, 129, 141, 152, 153, 162, 168, 170, 177, 183, 184, 187, 189, 196, 210, 222, 230, 235, 244, 248, 252, 259, 265, 270, 274, 285, 291, 299, 300, 309, 313, 316, 325, 339, 350, 356, 366, 375, 376, 381, 404, 417, 421, 430, 434, 450, 455, 466, 469, 473, 485, 496, 499, 505, 512, 514, 523, 525, 529, 543, 553, 564, 582, 583, 588, 590, 605, 606, 607, 615]
index: 2, ClusterItem: [2, 9, 25, 28, 31, 42, 49, 51, 52, 66, 68, 70, 71, 78, 79, 94, 95, 96, 98, 107, 113, 114, 116, 118, 127, 133, 135, 146, 148, 151, 157, 166, 176, 180, 182, 185, 190, 193, 198, 200, 208, 226, 238, 243, 247, 250, 254, 258, 263, 273, 277, 280, 281, 287, 295, 301, 303, 304, 312, 314, 317, 323, 331, 
338, 342, 347, 348, 351, 354, 360, 363, 368, 380, 387, 390, 395, 398, 400, 416, 418, 424, 425, 426, 436, 443, 453, 457, 458, 460, 465, 470, 471, 475, 481, 484, 488, 490, 491, 492, 493, 497, 498, 515, 522, 542, 544, 549, 551, 552, 558, 562, 571, 575, 576, 579, 593, 599, 600, 613, 614]
index: 3, ClusterItem: [5, 11, 14, 15, 22, 23, 26, 48, 50, 73, 85, 99, 100, 104, 110, 117, 131, 136, 144, 154, 155, 160, 188, 191, 192, 199, 202, 206, 209, 214, 216, 219, 227, 240, 242, 260, 276, 290, 293, 319, 321, 328, 344, 349, 357, 362, 364, 369, 394, 406, 407, 411, 433, 445, 454, 456, 461, 482, 509, 513, 528, 531, 541, 546, 548, 570, 572, 580, 591, 598, 601, 602, 604, 608, 620]
index: 4, ClusterItem: [16, 21, 45, 57, 61, 77, 87, 92, 93, 102, 108, 122, 134, 145, 163, 167, 179, 203, 218, 245, 264, 279, 284, 302, 305, 329, 335, 414, 423, 432, 463, 467, 483, 516, 559, 563, 566, 587, 596, 618]
index: 5, ClusterItem: [175]
index: 6, ClusterItem: [12, 13, 18, 19, 29, 30, 33, 35, 38, 39, 40, 41, 44, 59, 60, 62, 63, 72, 83, 89, 90, 119, 120, 123, 137, 142, 143, 147, 169, 172, 174, 181, 204, 207, 217, 221, 223, 224, 225, 229, 232, 236, 237, 251, 261, 262, 267, 268, 272, 282, 292, 294, 296, 308, 310, 324, 326, 327, 333, 337, 340, 352, 355, 
361, 365, 371, 373, 378, 383, 384, 386, 389, 392, 393, 396, 402, 422, 429, 431, 438, 440, 448, 449, 462, 464, 468, 474, 477, 480, 487, 489, 500, 501, 506, 508, 519, 524, 533, 534, 535, 540, 545, 550, 554, 556, 565, 569, 581, 585, 603, 610, 612]
index: 7, ClusterItem: [3, 6, 8, 17, 24, 32, 34, 37, 47, 55, 58, 64, 82, 84, 106, 109, 111, 115, 126, 132, 139, 140, 149, 150, 158, 159, 165, 171, 173, 178, 194, 195, 197, 201, 205, 211, 212, 228, 239, 241, 246, 249, 253, 255, 256, 269, 271, 278, 286, 289, 297, 298, 306, 315, 330, 334, 343, 353, 358, 359, 370, 377, 382, 385, 388, 391, 397, 401, 403, 405, 409, 410, 415, 419, 428, 435, 439, 441, 442, 444, 459, 472, 478, 479, 486, 495, 504, 507, 510, 511, 517, 520, 526, 527, 
530, 532, 536, 539, 547, 555, 557, 560, 561, 573, 578, 589, 595, 611, 616, 617, 619]
index: 8, ClusterItem: [7, 65, 69, 76, 81, 86, 97, 112, 121, 124, 128, 130, 138, 156, 161, 164, 186, 213, 215, 220, 231, 234, 257, 266, 275, 311, 318, 320, 332, 336, 341, 345, 346, 367, 374, 379, 399, 408, 412, 413, 420, 427, 437, 452, 494, 502, 518, 521, 537, 538, 568, 574, 577, 584, 592, 594, 609]
index: 9, ClusterItem: [476]

{91: {101: -0.016100425646793187, 233: -0.0025639464113411657, 283: 0.0, 288: -0.03590561201600614, 307: 0.0009918724211003278, 322: 0.025545573878333578, 372: 0.005361724130854423, 446: 1.4742642518133808e-30, 447: 1.7281765538257148e-30, 451: -0.028395911271322544, 503: 0.011807699261841859, 567: 0.00993276239041814, 586: -0.0019487367731448823, 597: -0.03027689152704634}, 101: {91: -0.016100425646793187, 233: -0.0014948102606802728, 283: 0.0, 288: 0.06944422925254529, 307: 0.004626184278386445, 322: 0.00638287007973179, 372: 0.001928775725015023, 446: -0.046399110005206544, 447: 2.4430512966612646e-28, 451: 0.012663695057443934, 503: -1.3672926688231765e-28, 567: 0.09111039235170695, 586: -0.003408407887516788, 597: 0.06470036067310801}, 233: {91: -0.0025639464113411657, 101: -0.0014948102606802728, 283: 0.0, 288: 3.1174452181329233e-28, 307: 0.0018786016307520842, 322: -0.030087028811691514, 372: 0.01651630330641192, 446: 0.0053075374090414025, 447: 0.01091182349770704, 451: 0.010921457868268585, 503: 2.925862490789818e-28, 567: -0.011619549870550961, 586: -3.062477785739326e-28, 597: -2.7938613678639764e-28}, 283: {91: 0.0, 101: 0.0, 233: 0.0, 288: 0.0, 307: 0.0, 322: 0.0, 372: 0.0, 446: 0.0, 447: 0.0, 451: 0.0, 503: 0.0, 567: 0.0, 586: 0.0, 597: 0.0}, 288: {91: -0.03590561201600614, 101: 0.06944422925254529, 233: 3.1174452181329233e-28, 283: 0.0, 307: 0.015385591185515874, 322: 0.03960893075312152, 372: 0.02848576828230447, 446: -0.02630908757101522, 447: -3.2033873193553054e-28, 451: 0.0061010520517661955, 503: 0.012014675758402123, 567: 0.003256659149943853, 586: 0.05552108997366415, 597: -0.02125526202651804}, 307: {91: 0.0009918724211003278, 101: 0.004626184278386445, 233: 0.0018786016307520842, 283: 0.0, 288: 0.015385591185515874, 322: 0.18958397304020155, 372: -0.02347612939466614, 446: 0.0022545391742642335, 447: -0.011918909429067771, 451: -0.007092876629534005, 503: -0.006106935866001242, 567: 0.0047566847216295675, 586: -0.045130879083884086, 597: -0.04908378442730335}, 322: {91: 0.025545573878333578, 101: 0.00638287007973179, 233: -0.030087028811691514, 283: 0.0, 288: 0.03960893075312152, 307: 0.18958397304020155, 372: -0.005680347352751897, 446: 0.11731586551929178, 447: 0.014617633655117153, 451: -0.004592621902543939, 503: 0.014979382430206571, 567: 0.022051428096726833, 586: -0.06489498159228943, 597: -0.05660363745400972}, 372: {91: 0.005361724130854423, 101: 0.001928775725015023, 233: 0.01651630330641192, 283: 0.0, 288: 0.02848576828230447, 307: -0.02347612939466614, 322: -0.005680347352751897, 446: -0.04908617508020118, 447: 1.4782205227895523e-28, 451: 0.02489961781398675, 503: -0.02819776122353701, 567: 0.025308172591852886, 586: -0.012461505480172726, 597: 0.012838343656472446}, 446: {91: 1.4742642518133808e-30, 101: -0.046399110005206544, 233: 0.0053075374090414025, 283: 0.0, 288: -0.02630908757101522, 307: 0.0022545391742642335, 322: 0.11731586551929178, 372: -0.04908617508020118, 447: -0.018707785571934563, 451: -0.017743249140027558, 503: 0.005751226520980872, 567: -0.06386150772462293, 586: -0.08960254904215982, 597: 2.4538405831848183e-28}, 447: {91: 1.7281765538257148e-30, 101: 2.4430512966612646e-28, 233: 0.01091182349770704, 283: 0.0, 288: -3.2033873193553054e-28, 307: -0.011918909429067771, 322: 0.014617633655117153, 372: 1.4782205227895523e-28, 446: -0.018707785571934563, 451: -0.006155281187730234, 503: -3.006579143575164e-28, 567: 0.009946482093980533, 586: 3.1469299748719126e-28, 597: 2.870952934240302e-28}, 451: {91: -0.028395911271322544, 101: 0.012663695057443934, 233: 0.010921457868268585, 283: 0.0, 288: 0.0061010520517661955, 307: -0.007092876629534005, 322: -0.004592621902543939, 372: 0.02489961781398675, 446: -0.017743249140027558, 447: -0.006155281187730234, 503: -0.009983822106133976, 567: 0.01250008930196037, 586: 0.01023122267891029, 597: 0.014664478805737213}, 503: {91: 0.011807699261841859, 101: -1.3672926688231765e-28, 233: 2.925862490789818e-28, 283: 0.0, 288: 0.012014675758402123, 307: -0.006106935866001242, 322: 0.014979382430206571, 372: -0.02819776122353701, 446: 0.005751226520980872, 447: -3.006579143575164e-28, 451: -0.009983822106133976, 567: 0.010192631901729105, 586: 0.02799609831567698, 597: 0.01308169335647891}, 567: {91: 0.00993276239041814, 101: 0.09111039235170695, 233: -0.011619549870550961, 283: 0.0, 288: 0.003256659149943853, 307: 0.0047566847216295675, 322: 0.022051428096726833, 372: 
0.025308172591852886, 446: -0.06386150772462293, 447: 0.009946482093980533, 451: 0.01250008930196037, 503: 0.010192631901729105, 586: -0.015139681783390471, 597: -0.01772940744420166}, 586: {91: -0.0019487367731448823, 101: -0.003408407887516788, 233: -3.062477785739326e-28, 283: 0.0, 288: 0.05552108997366415, 307: -0.045130879083884086, 322: -0.06489498159228943, 372: -0.012461505480172726, 446: -0.08960254904215982, 447: 3.1469299748719126e-28, 451: 0.01023122267891029, 
503: 0.02799609831567698, 567: -0.015139681783390471, 597: 0.030225945687507475}, 597: {91: -0.03027689152704634, 101: 0.06470036067310801, 233: -2.7938613678639764e-28, 283: 0.0, 288: -0.02125526202651804, 307: -0.04908378442730335, 322: -0.05660363745400972, 372: 0.012838343656472446, 446: 2.4538405831848183e-28, 447: 2.870952934240302e-28, 451: 0.014664478805737213, 503: 0.01308169335647891, 567: -0.01772940744420166, 586: 0.030225945687507475}, 1: {4: 0.030070244610458464, 10: -0.023198785565258635, 20: -0.005843674098470956, 27: -0.003514109693137553, 36: 0.03796356006194491, 43: -0.07496329613658782, 46: 2.579811564311685e-29, 53: -0.015193537343547753, 54: 0.056880960419035544, 56: 0.0074723212688561, 67: 0.03410849929436468, 74: -0.005075858759901014, 75: -0.13281506128835727, 80: 0.0895901975980248, 88: 0.0745010353752755, 103: 0.017206686831470867, 105: 9.662472816439928e-29, 125: -0.005428716102309017, 129: 0.023256841969025083, 
141: -0.008324089477650348, 152: -0.033565730532833925, 153: -0.010266840646726864, 162: 0.03591585123651396, 168: -0.012825373967305497, 170: 0.01598090467922777, 177: -0.011070854549298603, 183: 0.0021245100804309384, 184: 0.058192557302445616, 187: -0.015054205980538181, 189: 0.007511635005544208, 196: -0.015955779755844682, 210: 3.980244604024598e-29, 222: -0.004980102427597509, 230: 0.06328544881338025, 235: -0.03459757872619114, 244: -0.0452309626558739, 248: -0.006364253793087107, 252: 1.2379853590669962e-28, 259: 0.051233368275312385, 265: 0.004214325123969435, 270: -0.02939376493377572, 274: 0.0037879236683808766, 285: 
-0.0017693120391682002, 291: -0.02648745207913459, 299: 0.06622815172297587, 300: 0.03940054220030179, 309: 0.05701924560729297, 313: -0.0017824321066716557, 316: 0.019632748909408325, 325: -1.0375729465045877e-28, 339: 0.07683559715147296, 350: -0.0342781329276964, 356: 1.4309792648529394e-31, 366: 0.023248481626559847, 375: 0.03551164719564759, 376: 0.016325827052446614, 381: -0.039994472238678455, 404: -0.010109482328358706, 417: -0.004601708125666924, 421: 0.008674786311611234, 430: -0.0025966898576479107, 434: -0.0019469758324716414, 450: 0.042608190849947505, 455: -0.06567425440150593, 466: -0.00549492500302716, 469: 0.0014839111047430977, 473: 0.0005484969480352828, 485: 0.05083070410973378, 496: -0.022091251516306178, 499: -0.008482372507556494, 505: 0.07116648276537677, 512: 
-0.03313051801599376, 514: -0.01884191906217953, 523: 0.02410579791506535, 525: -0.012933647956928687, 529: -0.010311492619702198, 543: 0.021288675027571088, 553: 0.005888868420968855, 564: 0.028551440666026866, 582: 0.028446279282561902, 583: 0.0558585514063625, 588: 0.04317198179963191, 590: -0.00786944036676961, 605: -0.016540168686194155, 606: -0.04490125469125357, 607: 0.049599422036387675, 615: 0.03292905141380046}, 4: {1: 0.030070244610458464, 10: -0.043617644330294046, 20: 0.008989442686872653, 27: -0.003003236885783281, 36: -0.07967546893869273, 43: 0.0, 46: -4.7072390275795614e-29, 53: -0.008526353047035373, 54: -0.005603521152094084, 56: 0.022641319497436016, 67: 0.027983892268247743, 74: 8.63452344054748e-29, 75: 0.0024157360547483173, 80: -0.0024842477734130816, 88: 4.395402899550843e-31, 103: 0.01977598568282321, 105: 0.0652642441160169, 125: 0.027243589817665437, 129: 0.04946353449817046, 141: -3.385430650154862e-28, 152: -4.360554723685698e-32, 153: -1.017486990522724e-28, 162: 0.019925474682204562, 168: 0.035622768920768794, 170: -0.01741021742001988, 177: 0.007676230486264322, 183: 0.013617404395973393, 184: -0.05044200409663059, 187: -0.0007314963950813642, 189: -0.04116924825225093, 196: -1.4990388327174315e-28, 210: -4.7712276024714084e-29, 222: -0.07159065710097647, 230: 0.013512246312843791, 235: 0.0017603273254939381, 244: 0.028068531341921606, 248: -0.09026206254358489, 252: -0.0032209195508675716, 259: 0.01669158968429616, 265: -0.0758123367986287, 270: -0.002225873304427845, 274: -0.010943699505896055, 285: 3.9024103308219038e-31, 291: -0.10037442054219844, 299: 0.015436380671593166, 300: -0.010752149807913601, 309: 0.08790070698977434, 313: 0.0033777664051608796, 316: -0.027409647856842186, 325: 9.729323959204923e-29, 339: 0.12696274610200964, 350: 0.02921600486983333, 356: -1.3422588412548376e-31, 366: 0.1255953882883682, 375: -0.04905615015532264, 376: 0.021716832144351075, 381: 0.025989531816789417, 404: -1.038942667935032e-28, 417: 0.05112539739405255, 421: 1.2895615878351526e-28, 430: -6.081964656439721e-29, 434: -0.002237697853449595, 450: -0.005098978146017776, 455: 0.17997915441414616, 466: -0.029425475258835144, 469: -0.036233819448255315, 473: 0.0, 485: 0.09183394795839095, 496: -0.02844832655277178, 499: 0.05041406748347831, 505: 0.01721334079994029, 512: 8.341108486723626e-29, 514: -0.0815072036133124, 523: -0.005159686018840651, 525: 0.00019738188130876403, 529: 0.10686941624621749, 543: 0.041869695829353425, 553: 0.010417352022753183, 564: -0.08161947393685101, 582: -0.026015020180199126, 583: 0.04176420188615974, 588: -0.03641498140075051, 590: 0.016886990964024375, 605: 0.020230765228195443, 606: 9.500785263205699e-29, 607: -5.622136211576452e-32, 615: 0.033570139060265444}, 10: {1: -0.023198785565258635, 4: -0.043617644330294046, 20: -0.003112598627751728, 27: -0.02227096375993909, 36: 0.020510003790650565, 43: 0.023476004612860413, 46: 0.027593916425581344, 53: -0.0006147456083447782, 54: 0.019780312025648256, 56: -0.0389828378160297, 67: -0.016565207918763904, 74: -0.028838680587134475, 75: -0.04930273576714907, 80: 0.01009709504485765, 88: -0.003981401301720497, 103: 0.010753998678708309, 105: -0.038081434422785006, 125: 0.01174188128608524, 129: -0.05554325463759778, 141: 0.003694814405118447, 152: -0.053170412961914396, 153: 0.012494168580704065, 162: -0.0024495493577744334, 168: -0.035105599931150616, 170: 0.01605430333140242, 177: 0.05594566873501678, 183: 0.021403389859083907, 184: 
0.03127155175359516, 187: -0.004471626644732198, 189: 0.026180640992775783, 196: -0.017037404669869208, 210: 0.0036685345610551045, 222: 0.00292398246602137, 230: 0.008049483642301894, 235: -0.0163127438444893, 244: -0.009789591552414597, 248: 0.056435263389444115, 252: -0.03418940404407474, 259: 0.019700456088876255, 265: 0.03145088697338226, 270: -0.01062478298002818, 274: -0.052421433612105696, 285: -0.03524663151525177, 291: -0.0032525319895473676, 299: -0.05216267504656466, 300: -0.01054771549803304, 309: -0.038712590999610885, 313: -0.0022152712745776852, 316: 0.05601536378328163, 325: 0.028200662503033224, 339: -0.027847639738224045, 350: 0.05292294038383237, 356: 0.01787089614864656, 366: -0.0450663204842061, 375: -0.010209891343746528, 376: -0.00028513673456215954, 381: 0.0038940639319463032, 404: 0.00772031322624689, 417: 0.031455433744955956, 421: 0.014262813157995163, 430: 0.027828204894126234, 434: 0.08452514564